---
title: "Analysis"
description: null
toc: yes
featuredVideo: null
featuredImage: null
draft: no
---

<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>
<link href="/rmarkdown-libs/lightable/lightable.css" rel="stylesheet" />

<div id="TOC">

</div>

<div id="rubric-on-this-page" class="section level2">
<h2>Rubric: On this page</h2>
<p>you will</p>
<ul>
<li><p>Introduce what motivates your Data Analysis (DA)</p>
<ul>
<li>Which variables and relationships are you most interested in?</li>
<li>What questions are you interested in answering?</li>
</ul>
<p>The world population just break through 8 billion recently. According to World Food Programme, around 828 million of people go to bed hungry every night all around the world and more than 49 million people in 49 countries are facing famine crisis. Our team is interested in exploring the relationships between food supply, food waste, GDP, population density and available land for agriculture among different countries. Furthermore, we are looking forward to explore potential opportunities to mitigate food-waste and calculate world food availability for our current population density.</p>
<p>As such, we aim to examine the relationship of food security on a worldwide scale using several macro indicators to better understand factors that contribute to food waste. The main variables that we have built our model on are Food Production, GDP, Agriculture as Percentage of GDP, Land Used for Agriculture, Population, and Regions/Continents. One of the primary focuses of our analysis is to look into how food waste may differ by regions and the factors driving the disparity. Therefore, we have selected variables that can, to an extent, provide insight on characteristics of a region.</p></li>
</ul>
<p>Some of the hypotheses driving our analysis can be seen below:
GDP is a relatively effective signal of a country’s development; thus, “The developed regions waste a greater percentage of food”.
“The greater quantity of food production, the greater amount of food waste percentage”
“The greater percentage of agriculture as GDP, the greater amount of food wasted”</p>
<p>While our analysis is quantitatively-driven, …</p>
<p>US have the most “over 40% food loss per commodity per year” up to today, which is around two times the amount Mexico have. It is unimaginable how some commodity lose almost of its amount during production &amp; retail process. We want to look deeper into which commodity are incurring the most loss in US and if there is any reason behind it.</p>
<p><img src="/analysis_files/figure-html/1-1.png" width="672" /></p>
<p>The following graph indicates that in the US, Pineapple juice, Orange juice and grapefruit juice have been wasted the most over the past decades. One commonality between the most-wasted-commodity is that they are all juice. We may want to explore where did most of the waste occur in the production &amp; retail process of these juice.</p>
<p><img src="/analysis_files/figure-html/2-1.png" width="672" />
The following graph explores the sum food waste per year in the United States. In 2008, US incurred the most amount of food waste in the past five decades. A possible explanation for this severe food waste year is that during the depression, a lot of food are wasted because a lot of retailer and food processor went out of business. We may need more data to back up our hypothesis.</p>
<p><img src="/analysis_files/figure-html/3-1.png" width="672" />
The following data further explore the most wasted food in US. Besides from juice, we observe that Canned mushrooms, Tomatoes and Spinach are also among the highest wasted food in the US.</p>
<pre><code>## # A tibble: 85 × 2
##    commodity        sum_loss_per_year
##    &lt;chr&gt;                        &lt;dbl&gt;
##  1 Pineapple juice              2012.
##  2 Canned mushrooms             1705 
##  3 Orange juice                 1480.
##  4 Grapefruit juice             1460.
##  5 Apple juice                  1307.
##  6 Green garlic                  935.
##  7 Grape juice                   933.
##  8 Tomatoes                      756.
##  9 Spinach                       618.
## 10 Okra                          592.
## # … with 75 more rows</code></pre>
<ul>
<li>Breadth of the DA
<ul>
<li>Make sure that you ask enough initial questions to explore the different variables in your data.</li>
<li>i.e. Do you explore more than just one or two variables? Do you explore a few different relationships or many?</li>
</ul></li>
</ul>
<p>Our whole analysis revolved around food waste loss in different countries over time. Therefore, not only can we focus on food waste loss in a single year, but also food waste within a span. Therefore our questions are based around this concept:
Has food waste decreased/increased over time?
Is there a relationship between a country’s GDP and food waste ?
Are there specific countries that are outliers (waste much more/less food than everyone else)
What is the projected food waste loss for a specific region in 2023?</p>
<ul>
<li>Depth of the DA
<ul>
<li>When you answer one question, usually more questions arise as well.</li>
<li>The depth of the DA is about coming up with and exploring the answers to these questions, often iterating the process a few times.</li>
</ul></li>
</ul>
<p>Answering these questions may seem simple at first glance, but as it turns out, there are a bunch of countries in the world. In order to be able to compare all of the different countries’ food loss within a certain timeframe, we want to be able to display the data in a simple user-friendly manner. For this, we could plot every country in a heatmap. To see whether food loss has decreased over time worldwide, we could do a geom dot plot with a geom line to see the relationship.</p>
<ul>
<li>Modeling and Inference
<ul>
<li>You should also include some kind of formal statistical model and/or inference. This could be a linear regression, logistic regression, hypothesis testing etc.</li>
<li>Explain the techniques you used for validating your results.</li>
<li>Describe the results of your modelling and make sure to give a sense of the uncertainty in your estimates and conclusions.</li>
</ul></li>
</ul>
<pre class="r"><code>AggData &lt;- read_csv(here::here(&quot;dataset/AggData.csv&quot;))</code></pre>
<pre><code>## Rows: 54 Columns: 8
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (8): GDP, AgriGDP, AgriLand, Population, Year, Loss, Production, LossPer...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>load(here::here(&quot;dataset/AggData.RData&quot;))</code></pre>
<pre class="r"><code>model1 &lt;- lm(Loss ~ Production, data = AggData)
summary(model1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Loss ~ Production, data = AggData)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -585087131 -115732941  -28574344  142025080  663246104 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 8.700e+08  8.753e+07   9.939 1.28e-13 ***
## Production  1.818e-02  5.559e-03   3.270  0.00191 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 208500000 on 52 degrees of freedom
## Multiple R-squared:  0.1706, Adjusted R-squared:  0.1546 
## F-statistic:  10.7 on 1 and 52 DF,  p-value: 0.00191</code></pre>
<pre class="r"><code>model2 &lt;- lm(Loss ~ Year + GDP + AgriGDP + AgriLand + Population + Production, data = AggData)
summary(model2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Loss ~ Year + GDP + AgriGDP + AgriLand + Population + 
##     Production, data = AggData)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -401785287  -99038421  -10308608  112454861  588290004 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) -6.277e+11  2.190e+11  -2.866  0.00625 **
## Year         3.224e+08  1.127e+08   2.860  0.00635 **
## GDP          6.403e-06  9.913e-06   0.646  0.52157   
## AgriGDP     -5.089e+07  7.730e+07  -0.658  0.51358   
## AgriLand     3.005e+08  1.639e+08   1.834  0.07316 . 
## Population  -5.027e+00  1.449e+00  -3.470  0.00114 **
## Production   2.169e-01  1.012e-01   2.143  0.03745 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 182800000 on 46 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.4239, Adjusted R-squared:  0.3488 
## F-statistic: 5.642 on 6 and 46 DF,  p-value: 0.0001869</code></pre>
<pre class="r"><code>suppressPackageStartupMessages(library(olsrr))</code></pre>
<pre><code>## Warning: package &#39;olsrr&#39; was built under R version 4.2.2</code></pre>
<pre class="r"><code>suppressPackageStartupMessages(library(kableExtra))</code></pre>
<pre><code>## Warning: package &#39;kableExtra&#39; was built under R version 4.2.2</code></pre>
<pre class="r"><code>all_variables &lt;- ols_step_all_possible(model2) 
colnames(all_variables)[1:5] &lt;- c(&#39;Index&#39;, &#39;n&#39;, &#39;Predictors&#39;, &#39;R-Square&#39;, &#39;Adj R-Square&#39;)

all_variables %&gt;% 
  head(10) %&gt;% 
  summarise(Index, n, Predictors, `R-Square`, `Adj R-Square`) %&gt;% 
  kbl(caption = &quot;All Possible Variables&quot;) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;, fixed_thead = T)</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-5">Table 1: </span>All Possible Variables
</caption>
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Index
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
n
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Predictors
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
R-Square
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Adj R-Square
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
AgriGDP
</td>
<td style="text-align:right;">
0.2347192
</td>
<td style="text-align:right;">
0.2197137
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
AgriLand
</td>
<td style="text-align:right;">
0.2133760
</td>
<td style="text-align:right;">
0.1982486
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Year
</td>
<td style="text-align:right;">
0.1939272
</td>
<td style="text-align:right;">
0.1784258
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Population
</td>
<td style="text-align:right;">
0.1888800
</td>
<td style="text-align:right;">
0.1732816
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Production
</td>
<td style="text-align:right;">
0.1705889
</td>
<td style="text-align:right;">
0.1546387
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
GDP
</td>
<td style="text-align:right;">
0.1439178
</td>
<td style="text-align:right;">
0.1274546
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Year Population
</td>
<td style="text-align:right;">
0.2951072
</td>
<td style="text-align:right;">
0.2674643
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
GDP AgriLand
</td>
<td style="text-align:right;">
0.2525274
</td>
<td style="text-align:right;">
0.2232147
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
AgriLand Production
</td>
<td style="text-align:right;">
0.2519245
</td>
<td style="text-align:right;">
0.2225882
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Year AgriLand
</td>
<td style="text-align:right;">
0.2475960
</td>
<td style="text-align:right;">
0.2180899
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>ols_step_forward_p(model2) </code></pre>
<pre><code>## 
##                                 Selection Summary                                  
## ----------------------------------------------------------------------------------
##         Variable                  Adj.                                                
## Step    Entered     R-Square    R-Square     C(p)         AIC            RMSE         
## ----------------------------------------------------------------------------------
##    1    AgriGDP       0.2347      0.2197    12.1090    2180.4885    200101907.9473    
## ----------------------------------------------------------------------------------</code></pre>
<ul>
<li>Explain the flaws and limitations of your analysis
<ul>
<li>Are there some assumptions that you needed to make that might not hold? Is there other data that would help to answer your questions? …</li>
</ul></li>
</ul>
<p>One assumption that we initially made was that our food waste dataset held data for every country and every year. We were first proven wrong when we realized that some countries ceased to exist or began existing throughout the time period recorded. Also, there are years in which some countries may be missing data. This is due to the fact that the way our data was initially collected by the FAO (Food and Agriculture Org) was basically by going through old documents that the country may have provided. This does not work when countries do not really prioritize collecting this information.</p>
<p>The first flaw (no consistent data on a year-to-year basis) led to us believing that we could make a yearly analysis for every country. Therefore, when we started pumping out some graphs and a heat map for certain years, we got some “blank” spaces. Thus we realized that this flaw sort of forced us to work on a over-the-year basis instead. Of course this was not the case for every country, as places such as the United Stated are usually always good about collecting data.</p>
<ul>
<li>Clarity Figures
<ul>
<li>Are your figures/tables/results easy to read, informative, without problems like overplotting, hard-to-read labels, etc?</li>
<li>Each figure should provide a key insight. Too many figures or other data summaries can detract from this.</li>
</ul></li>
</ul>
<p>We believe that our graphs are actually quite easy to glance at. While making these graphs, we wanted to design them in a way that they could possibly be the first iteration of something that can be used in the “interactive” part of this project. For example, the heatmap we made at the beginning quickly helped us understand which country was a “problem” when it came to food waste.</p>
<ul>
<li>Clarity of Explanations
<ul>
<li>Do you introduce why you are doing each analysis?</li>
<li>How well do you explain each figure/result?</li>
<li>Do you provide interpretations that suggest further analysis or explanations for observed phenomenon?</li>
</ul></li>
<li>Organization and cleanliness.
<ul>
<li>Make sure to remove excessive warnings, use clean easy-to-read code, organize with sections or multiple pages, use bullets, etc.</li>
</ul></li>
</ul>
<p><strong>NOTE</strong>: Your Data Analysis can be broken up into multiple pages if that helps with your organization.</p>
</div>
